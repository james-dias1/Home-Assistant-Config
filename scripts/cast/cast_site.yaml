---
alias: Cast Site
mode: single
icon: 'mdi:cast'
variables:
  full_path: '{{ iif(path is undefined, "lovelace/0", iif(path.startswith("/"), path[1:], path)) }}'
  dashboard_path: '{{ full_path.split("/")[0] }}'
  view_path: '{{ full_path.split("/")[1] }}'
sequence:
  - service: script.debug
    data:
      message: |
        entity_id: "{{ display|default("media_player.google_kitchen") }}"
        full_path: "{{ full_path }}"
        dashboard_path: "{{ dashboard_path }}"
        view_path: "{{ view_path }}"

  - service: cast.show_lovelace_view
    data:
      entity_id: '{{ display|default("media_player.google_kitchen") }}'
      dashboard_path: '{{ dashboard_path }}'
      view_path: '{{ view_path }}'

  - delay:
      seconds: '{{ dismiss_after|default(60) }}'

  - service: script.cast_stop
    data:
      entity_id: '{{ display|default("media_player.google_kitchen") }}'

fields:
  display:
    description: Select the Google cast display.
    selector:
      entity:
        integration: cast
  path:
    description: Path to the page on this server.
    example: lovelace/cameras
    required: false
    selector:
      text:
  dismiss_after:
    description: "Reset the display after # seconds."
    required: false
    selector:
      number:
        min: 60
        max: 300
