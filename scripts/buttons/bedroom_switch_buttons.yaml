---
sequence:
  # - service: persistent_notification.create
  #   data_template:
  #     title: "bedroom_switch_buttons"
  #     message: |
  #       {%- set button = side.split('_')[0]  %}
  #       {%- set type = side.split('_')[1]  %}

  #       {{ button }}
  #       {{ type }}

  #       {% if type == "double" -%}
  #         switch.toggle
  #       {% elif type == "single" -%}
  #         light.toggle
  #       {% endif %}

  - service_template: >
      {%- set button = side.split('_')[0]  %}
      {%- set type = side.split('_')[1]  %}

      {%- if type == "double" -%}
        switch.toggle
      {%- elif type == "single" -%}
        light.toggle
      {%- endif %}
    data_template:
      entity_id: >
        {%- set button = side.split('_')[0]  %}
        {%- set type = side.split('_')[1]  %}

        {%- set button_press = {
            "left": {
              "single": "light.bedroom",
              "double": "switch.sound_machine"
            },
            "right": {
              "single": "light.brian",
              "double": "switch.bedroom_fan"
            },
            "both": {
              "single": "light.glowforge",
              "double": "switch.sound_machine, switch.bedroom_fan"
            }
          }
        -%}
        {{ button_press[button][type] }}
