---
# button presses:
#   0   Release
#   1   on
#   4   off
#   8   dim_up
#   16  dim_down
#   2   preset
lutron_pico_button_handler:
  sequence:
    # - service: persistent_notification.create
    #   data_template:
    #     title: "lutron_pico_button_handler"
    #     message: >
    #       {% if button == "4" -%}
    #         script.lutron_pico_light_off
    #       {%- else -%}
    #         script.lutron_pico_light_on
    #       {%- endif %}
    #       remote = "{{ remote }}"
    #       area =   "{{ area|lower|replace(' ','_')|replace('playroom','play_room') }}"
    #       button = "{{ button }}"
    #       light =  "{{ 'light.' + area|lower|replace(' ','_')|replace('playroom','play_room') }}"

    - service_template: >
        {% set area = area|lower|trim|replace(' ','_')|replace('playroom','play_room') -%}
        {%- if area == "dining_room" -%}
          {%- if button == "4" -%}
            script.lutron_pico_generic_light_off
          {%- else -%}
            script.lutron_pico_generic_light_on
          {%- endif %}

        {%- else -%}
          {%- if button == "2" -%}
            script.lutron_pico_middle_toggle
          {%- endif %}
        {%- endif -%}
      data_template:
        remote: "{{ remote|trim|replace('sensor.','')|replace('_remote','') }}"
        button: "{{ button }}"
        light:  "{{ 'light.' + area|lower|replace(' ','_') }}"
