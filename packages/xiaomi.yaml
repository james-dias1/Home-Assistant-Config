homeassistant:
  customize:
    binary_sensor.shoe_closet_door:
      device_class: door
      hide_if_away: true
    binary_sensor.glowforge_window:
      device_class: window
      hide_if_away: true
    #binary_sensor.playroom_fan_button
    #light.family_room_nightlight
    #sensor.xiaomi_gateway_illumination

################################################
## Component Settings
################################################
xiaomi_aqara:
  discovery_retry: 5
  gateways:
    - mac: !secret xiaomi_mac1
      key: !secret xiaomi_key1

################################################
## Automations
################################################
automation:
  - alias: 'Xiaomi: Auto Nightlight On'  
    hide_entity: True
    initial_state: True
    trigger:
      - platform: numeric_state
        entity_id: sensor.xiaomi_gateway_illumination
        below: '300'
    condition:
      condition: and
      conditions:
      - condition: state
        entity_id: light.family_room_nightlight
        state: 'off'
      #- condition: state
      #  entity_id: input_boolean.auto_nightlight
      #  state: 'on'
    action:
      - service: homeassistant.turn_on
        data:
          entity_id: light.family_room_nightlight
          brightness: 10
          rgb_color: [255, 255, 255]

  - alias: 'Xiaomi: Auto Nightlight Off'
    hide_entity: True
    initial_state: True
    trigger:
      - platform: numeric_state
        entity_id: sensor.xiaomi_gateway_illumination
        above: '400'
    condition:
      condition: state
      entity_id: light.family_room_nightlight
      state: 'on'
    action:
      - service: homeassistant.turn_off
        data:
          entity_id: light.family_room_nightlight