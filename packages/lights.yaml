homeassistant:
  customize:
    group.all_lights:
      hidden: false
    #light.entry:
    #  hidden: true
    light.hue:
      hidden: true
    #light.entry_light:
    #  friendly_name: "Entry"
    #light.porch_light:
    #  friendly_name: "Porch"
    switch.entry_step_light:
      friendly_name: "Step Warning"

    #input_boolean.bedroom_light_sync_enabled:
    #  persistent: true
    #input_boolean.time_based_dimmers_enabled:
    #  persistent: true

################################################
## Component Settings
################################################

## Insteon Dimmer Plugs
#######################
insteon_local:
  host: 10.0.0.30
  username: !secret insteon_user
  password: !secret insteon_pass
  timeout: 300

################################################
## Switches
################################################
input_boolean:
  bedroom_light_sync_enabled:
    name: Bedroom Light Sync
    icon: mdi:lightbulb-outline
    initial: on

  time_based_dimmers_enabled:
    name: Time Based Lights
    icon: mdi:weather-sunset
    initial: on

################################################
## Logical Groups
################################################
group:
  # excluding night lights (eg. Kid's Bathroom & Porch)
  interior_lights:
    entities:
      - light.bedroom_light
      - light.brians_light
      - light.entry_light
      - light.dining_room_light
      - light.family_room_light
      - light.family_room_table_lamp
      - light.kitchen_sink_light
      - light.living_room_light
      - light.living_room_corner_lamp
      - light.play_room_light
      - light.computer_desk_light
    name: Interior Lights
    icon: mdi:lightbulb
    control: hidden
    view: no

  interior_switches:
    entities:
      - switch.entry_step_light
      - switch.kitchen_prep_light
      - switch.kitchen_stove_light
    name: Interior Switches
    icon: mdi:light-switch
    control: hidden
    view: no

################################################
## Sensors
################################################
sensor:
  - platform: template
    sensors:
      lights_on:
        value_template: >
          {% macro get_lights_on() -%}
            {% set comma = joiner(', ') -%}
            {%- for group in states.light|groupby('state') -%}
              {%- for entity in group.list -%}
                {%- if entity.state == 'on' and 
                    entity.entity_id.split('.')[0]|lower == 'light' and 
                    entity.entity_id|lower != 'light.boys_bathroom_nightlight' and 
                    entity.entity_id|lower != 'light.entry' and 
                    entity.entity_id|lower != 'light.hue' and 
                    entity.entity_id|lower != 'light.porch_light' and 
                    entity.entity_id|lower != 'light.porch_light_color'  -%}
                  {% if not loop.first %}{{ comma() }}{% endif %}
                  {{ entity.entity_id }}
                {%- endif -%}
              {%- endfor -%}
            {%- endfor -%}
          {%- endmacro %}
          {{ get_lights_on() }}

  - platform: template
    sensors:
      lights_on_friendly:
        value_template: >
          {% macro get_lights_on_friendly() -%}
            {% set comma = joiner(', ') -%}
            {%- for group in states.light|groupby('state') -%}
              {%- for entity in group.list -%}
                {%- if entity.state == 'on' and 
                    entity.entity_id.split('.')[0]|lower == 'light' and 
                    entity.entity_id|lower != 'light.boys_bathroom_nightlight' and 
                    entity.entity_id|lower != 'light.entry' and 
                    entity.entity_id|lower != 'light.hue' and 
                    entity.entity_id|lower != 'light.porch_light' and 
                    entity.entity_id|lower != 'light.porch_light_color'  -%}
                  {{ ' and' if loop.last and not loop.first else comma() }}
                  {{ entity.entity_id|replace('light.','')|replace('_',' ')|title }}
                {%- endif -%}
              {%- endfor -%}
            {%- endfor -%}
          {%- endmacro %}
          {{ get_lights_on_friendly() }}
          

################################################
## Lights
################################################
light:
  platform: insteon_local

################################################
## Switches
################################################
switch:
  platform: insteon_local