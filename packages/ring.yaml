homeassistant:
  customize:
    camera.front_door:
      friendly_name: "Porch"
      homebridge_hidden: false

    binary_sensor.front_door_motion:
      friendly_name: "Porch Motion"
      device_class: motion

    sensor.ring_front_door_last_activity:
      friendly_name: "Last Porch Activity"
      homebridge_hidden: false

input_text:
  fake_doorbell:
    initial: "off"


################################################
## Component Settings
################################################
ring:
  username: !secret email1
  password: !secret ring_pass

################################################
## Cameras
################################################
camera:
  - platform: ring
    scan_interval: 90

################################################
## Sensors
################################################
binary_sensor:
  - platform: ring
    monitored_conditions:
      - ding
      - motion

sensor:
  - platform: ring
    monitored_conditions:
      - last_activity
      - last_ding
      - last_motion
    #  - volume
    #  - wifi_signal_category
    #  - wifi_signal_strength


script:
  test_doorbell:
    sequence:
      - service: input_text.set_value
        data:
          entity_id: input_text.fake_doorbell
          value: "on"
      - delay: "00:00:01"
      - service: input_text.set_value
        data:
          entity_id: input_text.fake_doorbell
          value: "off"

################################################
## Automation
################################################
automation:
  - alias: Doorbell Pressed
    trigger:
      - platform: state
        entity_id:
          - binary_sensor.ring_front_door_ding
          - binary_sensor.ring_front_door_motion
          - input_text.fake_doorbell
        from: "off"
        to: "on"
    action:
      - service: camera.snapshot
        data_template:
          entity_id: camera.front_door
          filename: "/config/www/downloads/snapshot_front_doorbell.jpg"
      - service: script.notify_ios_engine
        data_template:
          title: "Front Door"
          message: "Someone is at the front door."
          image: "snapshot_front_doorbell.jpg"
      - service: logbook.log
        data:
          name: "Ring Camera:"
          message: "someone is at the front door."
#      - service: xiaomi_aqara.play_ringtone
#        data:
#          gw_mac: !secret xiaomi_mac1
#          ringtone_id: 10