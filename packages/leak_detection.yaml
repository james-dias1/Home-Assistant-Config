homeassistant:
  customize:
    ##### Moisture Sensor
    binary_sensor.kitchen_leak:
      device_class: moisture

################################################
## Automation
################################################
automation:
  - alias: Kitchen Sink Leak Detected
    trigger:
      platform: state
      entity_id: binary_sensor.kitchen_leak
      to: "on"
    action:
      - service: script.notify_speech
        data_template:
          media_player: >-
            "media_player.echo_master_bedroom,
             media_player.echo_play_room,
             media_player.echo_living_room,
             media_player.echo_kitchen,
             media_player.echo_family_room"
          message: "A leak has been detected in the kitchen!"

      - service: script.notify_ios
        data_template:
          title: "LEAK DETECTED!"
          message: "Kitchen Sink {{ as_timestamp(now()) | timestamp_custom('%I:%M:%S %p %d %b %Y', true) }}"
          who: "parents"

      - service: persistent_notification.create
        data:
          title: "LEAK DETECTED!"
          message: "Kitchen Sink - {{ as_timestamp(now()) | timestamp_custom('%I:%M:%S %p %d%b%Y', true) }}"