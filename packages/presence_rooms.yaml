homeassistant:
  customize:
    ##### Ecobee Occupancy Sensors
    binary_sensor.bedroom_occupancy:
      device_class: occupancy
    binary_sensor.home_occupancy:
      device_class: occupancy 
    binary_sensor.living_room_occupancy:
      device_class: occupancy
    binary_sensor.lucas_bedroom_occupancy:
      device_class: occupancy

    ##### Motion Sensors
    binary_sensor.family_room_motion:
      friendly_name: "Family Room"
      device_class: motion
    binary_sensor.kitchen_motion:
      friendly_name: Kitchen
      device_class: motion
    binary_sensor.kitchen_1_motion:
      friendly_name: "Kitchen Motion #1"
      device_class: motion
    binary_sensor.kitchen_2_motion:
      friendly_name: "Kitchen Motion #2"
      device_class: motion
    binary_sensor.living_room_motion:
      friendly_name: "Living Room"
      device_class: motion

    ##### Camera Motion Sensors
    binary_sensor.ring_front_door_motion:
      friendly_name: Porch
      device_class: motion
    sensor.workbench_motion_detected:
      friendly_name: Workbench
      device_class: motion

    ##### Mode overrides
    input_boolean.motion_detection_mode:
      persistent: true
    input_boolean.motion_detection_kitchen:
      persistent: true

################################################
## Binary Sensor Groups
################################################
binary_sensor:
  - platform: template
    sensors:
      kitchen_motion:
        friendly_name: Kitchen Motion
        device_class: motion
        value_template: >-
          {{ is_state('binary_sensor.kitchen_1_motion', 'on')
          or is_state('binary_sensor.kitchen_2_motion', 'on') }}

################################################
## Switches
################################################
input_boolean:
  motion_detection_mode:
    name: Motion Detection
    icon: mdi:account-search

################################################
## Automation
################################################
automation:
  ##############################################
  ###  Kitchen
  ##############################################
  - alias: "Kitchen Motion Light On"
    trigger:
      - platform: state
        entity_id: binary_sensor.kitchen_motion
        from: 'off'
        to: 'on'
    condition:
      - condition: state
        entity_id: input_boolean.motion_detection_mode
        state: 'on'
      # We don't need to turn on the light when the dogs are alone.
      - condition: state
        entity_id: input_boolean.away_mode
        state: 'off'
    action:
      - service: light.turn_on
        entity_id: light.kitchen_undercabinet

  - alias: "Kitchen Motion: Light Timeout"
    trigger:
      - platform: state
        entity_id: binary_sensor.kitchen_motion
        from: 'on'
        to: 'off'
        # for:
        #   minutes: 5
        #   seconds: 00
    condition:
      - condition: state
        entity_id: input_boolean.motion_detection_mode
        state: 'on'
    action:
      - service: light.turn_off
        entity_id: light.kitchen_undercabinet