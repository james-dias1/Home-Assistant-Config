homeassistant:
  customize_glob:
    # Hides UI Panels from smart hubs.
    "group.panel_*":
      hidden: false
      alexa_hidden: true
      emulated_hue_hidden: true
      homebridge_hidden: true
    
    # Hide unwanted items from smart hubs.
    "input_boolean.*_alarm_clock_*":
      hidden: true
      alexa_hidden: true
      emulated_hue_hidden: true
      homebridge_hidden: true
    "script.*_alarm_clock_*":
      hidden: true
      alexa_hidden: true
      emulated_hue_hidden: true
      homebridge_hidden: true
    "script.speech_*":
      hidden: true
      alexa_hidden: true
      emulated_hue_hidden: true
      homebridge_hidden: true
    "script.*_speech_*":
      hidden: true
      alexa_hidden: true
      emulated_hue_hidden: true
      homebridge_hidden: true

  customize:
    # Influence tab layout order.
    group.home:
      order: 1
    group.cameras:
      order: 2
    group.outside:
      order: 3
    group.admin:
      order: 99

    # Attempting to influence panel layout order.
    group.panel_control:
      order: 1
    group.panel_downstairs_lights:
      order: 2
    group.panel_downstairs_devices:
      order: 3
    group.panel_upstairs:
      order: 4



################################################
## Component Settings
################################################
# Enables configuration UI
config:

customizer:
  # Custom UI: https://github.com/andrey-git/home-assistant-custom-ui/
  #custom_ui: hosted #debug #Only use (debug) for reporting readable Javascript errors!
  #hide_attributes:
  #  - node_id
  #  - value_index
  #columns: 350, 700, 1050, 1400, 1850, 2100

# Source: https://github.com/pnbruckner/homeassistant-config
# custom_updater:
#   track:
#     - cards
#     - components
#     - python_scripts
#   # card_urls:
#   #   - https://raw.githubusercontent.com/rdehuyss/homeassistant-lovelace-alarm-clock-card/master/custom_updater.json
#   component_urls:
#     - https://raw.githubusercontent.com/pnbruckner/homeassistant-config/master/custom_components.json
#   python_script_urls:
#     - https://raw.githubusercontent.com/pnbruckner/homeassistant-config/master/python_scripts.json

# Discover some devices automatically
discovery:
  #enable:
  #  - homekit
  #ignore:
  #  - philips_hue

# Common component used by Ring Camera and others
# downloader:
#   download_dir: /config/www/downloads #appears as /local/downlads on the website

ffmpeg:
  ffmpeg_bin: /usr/bin/ffmpeg

frontend:
  #themes: !include_dir_merge_named /config/themes/

history: !include /config/recorder.yaml

# View all events in a logbook
logbook: !include /config/logbook.yaml

logger:
  default: error
  #logs:
  #  custom_components.influxdb: debug

python_script:

recorder: !include /config/recorder.yaml

# Checks for available updates
# Note: This component will send some information about your system to
# the developers to assist with development of Home Assistant.
# For more information, please see:
# https://home-assistant.io/blog/2016/10/25/explaining-the-updater/
updater:
  # Optional, allows Home Assistant developers to focus on popular components.
  include_used_components: true

zeroconf:


script:
  disable_speech_at_startup:
    sequence:
      - condition: state
        entity_id: input_boolean.speech_notifications
        state: 'on'
      - service: input_boolean.turn_off
        entity_id: input_boolean.speech_notifications
      - delay: '00:00:15'
      - service: input_boolean.turn_on
        entity_id: input_boolean.speech_notifications
      #- service: media_player.turn_on
      #  entity_id: media_player.living_room_speaker
      #- service: media_player.turn_on
      #  entity_id: media_player.play_room_speaker

#########################################
## Automation
#########################################
automation:
  - alias: Home Assistant Startup Actions
    trigger:
      platform: homeassistant
      event: start
    action:
      # - service: variable.set_variable
      #   data:
      #     variable: ha_laststartup
      #     value_template: "{{ as_timestamp(now()) }}"

      # Disable speech message that occurs everytime I restart HASS.
      #- service: script.turn_on
      #  entity_id: script.disable_speech_at_startup
      #- service: input_boolean.turn_off
      #  entity_id: input_boolean.speech_notifications

      # Make sure the Hot Water Pump is turned off at startup.
      - service: switch.turn_off
        entity_id: switch.sonoff_pow01

      # Sometimes the garage entry light turns on at startup, 
      # so turn it back off if the door is closed.
      - condition: state
        entity_id: cover.garage_door
        state: "closed"
      - service: light.turn_off
        entity_id: light.garage_entry_light


  - alias: Notify on Home Assistant Updates
    trigger:
      platform: state
      entity_id: updater.updater
    action:
      - service: script.notify_ios
        data_template:
          title: "Home Assistant Update Available"
          message: "{{ as_timestamp(now()) | timestamp_custom('%I:%M:%S %p %d %b %Y', true) }}"
          who: "brian"
      - service: persistent_notification.create
        data:
          title: "Update Available"
          message: "Home Assistant {{ states('updater.updater') }} is available. - {{ as_timestamp(now()) | timestamp_custom('%I:%M:%S %p %d%b%Y', true) }}"