---
alias: "Lucas' A/C Status Update"
id: lucas_ac_status_update
trigger:
  # Off
  - platform: numeric_state
    entity_id: sensor.lucas_ac_power
    below: 2
    for:
      seconds: 5
  # Idle
  - platform: numeric_state
    entity_id: sensor.lucas_ac_power
    below: 10
    above: 2
    for:
      seconds: 5
  # Fan
  - platform: numeric_state
    entity_id: sensor.lucas_ac_power
    below: 200
    above: 10
    for:
      seconds: 5
  # Cooling
  - platform: numeric_state
    entity_id: sensor.lucas_ac_power
    above: 200
    for:
      seconds: 5
variables:
  current_status: '{{ states("input_select.lucas_ac_status") }}'
  power: '{{ trigger.to_state.state|int }}'
  new_status: |
    {%- if power > 200 %}
      Cooling
    {%- elif power > 10 %}
      Fan
    {%- elif power > 0 %}
      Idle
    {%- else %}
      Off
    {% endif %}
action:
  - service: input_select.select_option
    data:
      entity_id: input_select.lucas_ac_status
      option: '{{ new_status }}'
