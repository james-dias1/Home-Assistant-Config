---
alias: Family Room TV Device Sync
id: family_room_tv_device_sync
description: Toggle all TV devices when the tv changes state.
initial_state: true
mode: single
trigger:
  - platform: state
    entity_id: media_player.tv_family_room
    for:
      seconds: 10
action:
  # - service: script.debug
  #   data:
  #     message: |
  #       {{ trigger.from_state }}
  #       {{ trigger.to_state }}
  
  - choose:
      # TV or Apple TV go from Off -> On
      - conditions:
          - '{{ trigger.from_state.state == "off"
              and trigger.to_state.state == "on" }}'
        sequence:
          - service: remote.turn_on
            entity_id: remote.apple_tv_family_room
          - service: switch.turn_on
            entity_id: switch.soundbar

      # TV or Apple TV go from On -> Off
      - conditions:
          - '{{ trigger.from_state.state == "on"
              and trigger.to_state.state == "off" }}'
        sequence:
          - service: remote.turn_off
            entity_id: remote.apple_tv_family_room
          - service: switch.turn_ff
            entity_id: switch.soundbar
