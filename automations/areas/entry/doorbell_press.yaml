---
# PLay a doorbell sound when the button is pressed.
alias: doorbell_press
initial_state: true
mode: single
trigger:
  - platform: state
    entity_id: binary_sensor.doorbell_press
    to: 'on'
action:
  # Stream the camera feed to Apple TV.
  - service: camera.play_stream
    data:
      entity_id: camera.front_door
      media_player: media_player.family_room_apple_tv

  # Stream the camera feed to all Home Assistant displays.
  - service: browser_mod.command
    data:
      command: more-info
      entity_id: camera.front_door

  # Display the message as a toast notification
  - service: script.toast
    data:
      message: "Someone pressed the doorbell!"
      duration: 0

  # - service: media_player.turn_on
  #   entity_id: media_player.family_room_speaker

  # - service: media_player.volume_set
  #   entity_id: media_player.family_room_speaker
  #   data_template:
  #     volume_level: >
  #       {% if now().strftime("%H")|int < 12 and now().strftime("%H")|int > 6%}
  #       0.25
  #       {% elif now().strftime("%H")|int > 12 and now().strftime("%H")|int < 17%}
  #       0.40
  #       {% else %}
  #       0.20
  #       {% endif %}

  # - service: media_player.play_media
  #   data_template:
  #     entity_id: media_player.family_room_speaker
  #     media_content_id: "http://10.0.0.5:8123/local/audio/jetsons-doorbell.mp3"
  #     media_content_type: music


  # Cool down timer. When "mode: single" this stops this automation from running more often than this.
  - delay:
      minutes: 10
