---
alias: wakeup_light_nerene
#initial_state: true
trigger:
  platform: template
  #value_template: "{{ states('sensor.time') == states('sensor.wakeup_nerene_time')|timestamp_custom('%H:%M', false) }}"
  value_template: "{{ states('sensor.time') == states('sensor.wakeup_light_nerene')|timestamp_custom('%H:%M', false) }}"
condition:
  - condition: state
    entity_id: person.nerene
    state: home
 # Continue today is a wakeup day.
  - condition: state
    entity_id: binary_sensor.wakeup_nerene_day
    state: "on"
action:
  # - service: persistent_notification.create
  #   data_template:
  #     title: "DEBUG"
  #     message: "automation.wakeup_nerene {{ states('sensor.wakeup_light_nerene')|timestamp_custom('%H:%M', false) }}"

  # Time to turn on the lights!
  # - service: script.turn_on
  #   entity_id: script.wakeup_nerene_light_start

  - service: script.turn_on
    data_template:
      entity_id: >
        {% if is_state('input_boolean.wakeup_nerene_skipnext', 'on') %}
          script.wakeup_nerene_skipnext
        {% else %}
          script.wakeup_nerene_light_start
        {% endif %}
